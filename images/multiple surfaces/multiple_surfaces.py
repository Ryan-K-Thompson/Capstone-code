# -*- coding: utf-8 -*-
"""
Created on Sun Oct 16 18:24:13 2022

@author: patag
"""

print('start')
import math
from mpl_toolkits import mplot3d
import numpy as np
import cantera as ct
import sympy as sympy
import scipy as scipy
from scipy.interpolate import griddata
# from mpl_toolkits import Axes3D
from scipy.interpolate import RectBivariateSpline
from sympy import symbols, Eq, solve
from scipy import interpolate
from scipy.optimize import fsolve, root
from sdtoolbox import postshock, stagnation
from sdtoolbox.postshock import PostShock_eq, PostShock_fr
from sdtoolbox.stagnation import stgsolve
from matplotlib import pyplot as plt
from matplotlib import cm


P0square = np.array([[50000,73684.2105263157,97368.4210526315,121052.631578947,144736.842105263,168421.052631578,192105.263157894,215789.47368421,239473.684210526,263157.894736842,286842.105263157,310526.315789473,334210.526315789,357894.736842105,381578.947368421,405263.157894736,428947.368421052,452631.578947368,476315.789473684,500000],[50000,73684.2105263157,97368.4210526315,121052.631578947,144736.842105263,168421.052631578,192105.263157894,215789.47368421,239473.684210526,263157.894736842,286842.105263157,310526.315789473,334210.526315789,357894.736842105,381578.947368421,405263.157894736,428947.368421052,452631.578947368,476315.789473684,500000],[50000,73684.2105263157,97368.4210526315,121052.631578947,144736.842105263,168421.052631578,192105.263157894,215789.47368421,239473.684210526,263157.894736842,286842.105263157,310526.315789473,334210.526315789,357894.736842105,381578.947368421,405263.157894736,428947.368421052,452631.578947368,476315.789473684,500000],[50000,73684.2105263157,97368.4210526315,121052.631578947,144736.842105263,168421.052631578,192105.263157894,215789.47368421,239473.684210526,263157.894736842,286842.105263157,310526.315789473,334210.526315789,357894.736842105,381578.947368421,405263.157894736,428947.368421052,452631.578947368,476315.789473684,500000],[50000,73684.2105263157,97368.4210526315,121052.631578947,144736.842105263,168421.052631578,192105.263157894,215789.47368421,239473.684210526,263157.894736842,286842.105263157,310526.315789473,334210.526315789,357894.736842105,381578.947368421,405263.157894736,428947.368421052,452631.578947368,476315.789473684,500000],[50000,73684.2105263157,97368.4210526315,121052.631578947,144736.842105263,168421.052631578,192105.263157894,215789.47368421,239473.684210526,263157.894736842,286842.105263157,310526.315789473,334210.526315789,357894.736842105,381578.947368421,405263.157894736,428947.368421052,452631.578947368,476315.789473684,500000],[50000,73684.2105263157,97368.4210526315,121052.631578947,144736.842105263,168421.052631578,192105.263157894,215789.47368421,239473.684210526,263157.894736842,286842.105263157,310526.315789473,334210.526315789,357894.736842105,381578.947368421,405263.157894736,428947.368421052,452631.578947368,476315.789473684,500000],[50000,73684.2105263157,97368.4210526315,121052.631578947,144736.842105263,168421.052631578,192105.263157894,215789.47368421,239473.684210526,263157.894736842,286842.105263157,310526.315789473,334210.526315789,357894.736842105,381578.947368421,405263.157894736,428947.368421052,452631.578947368,476315.789473684,500000],[50000,73684.2105263157,97368.4210526315,121052.631578947,144736.842105263,168421.052631578,192105.263157894,215789.47368421,239473.684210526,263157.894736842,286842.105263157,310526.315789473,334210.526315789,357894.736842105,381578.947368421,405263.157894736,428947.368421052,452631.578947368,476315.789473684,500000],[50000,73684.2105263157,97368.4210526315,121052.631578947,144736.842105263,168421.052631578,192105.263157894,215789.47368421,239473.684210526,263157.894736842,286842.105263157,310526.315789473,334210.526315789,357894.736842105,381578.947368421,405263.157894736,428947.368421052,452631.578947368,476315.789473684,500000],[50000,73684.2105263157,97368.4210526315,121052.631578947,144736.842105263,168421.052631578,192105.263157894,215789.47368421,239473.684210526,263157.894736842,286842.105263157,310526.315789473,334210.526315789,357894.736842105,381578.947368421,405263.157894736,428947.368421052,452631.578947368,476315.789473684,500000],[50000,73684.2105263157,97368.4210526315,121052.631578947,144736.842105263,168421.052631578,192105.263157894,215789.47368421,239473.684210526,263157.894736842,286842.105263157,310526.315789473,334210.526315789,357894.736842105,381578.947368421,405263.157894736,428947.368421052,452631.578947368,476315.789473684,500000],[50000,73684.2105263157,97368.4210526315,121052.631578947,144736.842105263,168421.052631578,192105.263157894,215789.47368421,239473.684210526,263157.894736842,286842.105263157,310526.315789473,334210.526315789,357894.736842105,381578.947368421,405263.157894736,428947.368421052,452631.578947368,476315.789473684,500000],[50000,73684.2105263157,97368.4210526315,121052.631578947,144736.842105263,168421.052631578,192105.263157894,215789.47368421,239473.684210526,263157.894736842,286842.105263157,310526.315789473,334210.526315789,357894.736842105,381578.947368421,405263.157894736,428947.368421052,452631.578947368,476315.789473684,500000],[50000,73684.2105263157,97368.4210526315,121052.631578947,144736.842105263,168421.052631578,192105.263157894,215789.47368421,239473.684210526,263157.894736842,286842.105263157,310526.315789473,334210.526315789,357894.736842105,381578.947368421,405263.157894736,428947.368421052,452631.578947368,476315.789473684,500000],[50000,73684.2105263157,97368.4210526315,121052.631578947,144736.842105263,168421.052631578,192105.263157894,215789.47368421,239473.684210526,263157.894736842,286842.105263157,310526.315789473,334210.526315789,357894.736842105,381578.947368421,405263.157894736,428947.368421052,452631.578947368,476315.789473684,500000],[50000,73684.2105263157,97368.4210526315,121052.631578947,144736.842105263,168421.052631578,192105.263157894,215789.47368421,239473.684210526,263157.894736842,286842.105263157,310526.315789473,334210.526315789,357894.736842105,381578.947368421,405263.157894736,428947.368421052,452631.578947368,476315.789473684,500000],[50000,73684.2105263157,97368.4210526315,121052.631578947,144736.842105263,168421.052631578,192105.263157894,215789.47368421,239473.684210526,263157.894736842,286842.105263157,310526.315789473,334210.526315789,357894.736842105,381578.947368421,405263.157894736,428947.368421052,452631.578947368,476315.789473684,500000],[50000,73684.2105263157,97368.4210526315,121052.631578947,144736.842105263,168421.052631578,192105.263157894,215789.47368421,239473.684210526,263157.894736842,286842.105263157,310526.315789473,334210.526315789,357894.736842105,381578.947368421,405263.157894736,428947.368421052,452631.578947368,476315.789473684,500000],[50000,73684.2105263157,97368.4210526315,121052.631578947,144736.842105263,168421.052631578,192105.263157894,215789.47368421,239473.684210526,263157.894736842,286842.105263157,310526.315789473,334210.526315789,357894.736842105,381578.947368421,405263.157894736,428947.368421052,452631.578947368,476315.789473684,500000]])
H0square = np.array([[24000000,24000000,24000000,24000000,24000000,24000000,24000000,24000000,24000000,24000000,24000000,24000000,24000000,24000000,24000000,24000000,24000000,24000000,24000000,24000000],[22863157.8947368,22863157.8947368,22863157.8947368,22863157.8947368,22863157.8947368,22863157.8947368,22863157.8947368,22863157.8947368,22863157.8947368,22863157.8947368,22863157.8947368,22863157.8947368,22863157.8947368,22863157.8947368,22863157.8947368,22863157.8947368,22863157.8947368,22863157.8947368,22863157.8947368,22863157.8947368],[21726315.7894736,21726315.7894736,21726315.7894736,21726315.7894736,21726315.7894736,21726315.7894736,21726315.7894736,21726315.7894736,21726315.7894736,21726315.7894736,21726315.7894736,21726315.7894736,21726315.7894736,21726315.7894736,21726315.7894736,21726315.7894736,21726315.7894736,21726315.7894736,21726315.7894736,21726315.7894736],[20589473.6842105,20589473.6842105,20589473.6842105,20589473.6842105,20589473.6842105,20589473.6842105,20589473.6842105,20589473.6842105,20589473.6842105,20589473.6842105,20589473.6842105,20589473.6842105,20589473.6842105,20589473.6842105,20589473.6842105,20589473.6842105,20589473.6842105,20589473.6842105,20589473.6842105,20589473.6842105],[19452631.5789473,19452631.5789473,19452631.5789473,19452631.5789473,19452631.5789473,19452631.5789473,19452631.5789473,19452631.5789473,19452631.5789473,19452631.5789473,19452631.5789473,19452631.5789473,19452631.5789473,19452631.5789473,19452631.5789473,19452631.5789473,19452631.5789473,19452631.5789473,19452631.5789473,19452631.5789473],[18315789.4736842,18315789.4736842,18315789.4736842,18315789.4736842,18315789.4736842,18315789.4736842,18315789.4736842,18315789.4736842,18315789.4736842,18315789.4736842,18315789.4736842,18315789.4736842,18315789.4736842,18315789.4736842,18315789.4736842,18315789.4736842,18315789.4736842,18315789.4736842,18315789.4736842,18315789.4736842],[17178947.368421,17178947.368421,17178947.368421,17178947.368421,17178947.368421,17178947.368421,17178947.368421,17178947.368421,17178947.368421,17178947.368421,17178947.368421,17178947.368421,17178947.368421,17178947.368421,17178947.368421,17178947.368421,17178947.368421,17178947.368421,17178947.368421,17178947.368421],[16042105.2631578,16042105.2631578,16042105.2631578,16042105.2631578,16042105.2631578,16042105.2631578,16042105.2631578,16042105.2631578,16042105.2631578,16042105.2631578,16042105.2631578,16042105.2631578,16042105.2631578,16042105.2631578,16042105.2631578,16042105.2631578,16042105.2631578,16042105.2631578,16042105.2631578,16042105.2631578],[14905263.1578947,14905263.1578947,14905263.1578947,14905263.1578947,14905263.1578947,14905263.1578947,14905263.1578947,14905263.1578947,14905263.1578947,14905263.1578947,14905263.1578947,14905263.1578947,14905263.1578947,14905263.1578947,14905263.1578947,14905263.1578947,14905263.1578947,14905263.1578947,14905263.1578947,14905263.1578947],[13768421.0526315,13768421.0526315,13768421.0526315,13768421.0526315,13768421.0526315,13768421.0526315,13768421.0526315,13768421.0526315,13768421.0526315,13768421.0526315,13768421.0526315,13768421.0526315,13768421.0526315,13768421.0526315,13768421.0526315,13768421.0526315,13768421.0526315,13768421.0526315,13768421.0526315,13768421.0526315],[12631578.9473684,12631578.9473684,12631578.9473684,12631578.9473684,12631578.9473684,12631578.9473684,12631578.9473684,12631578.9473684,12631578.9473684,12631578.9473684,12631578.9473684,12631578.9473684,12631578.9473684,12631578.9473684,12631578.9473684,12631578.9473684,12631578.9473684,12631578.9473684,12631578.9473684,12631578.9473684],[11494736.8421052,11494736.8421052,11494736.8421052,11494736.8421052,11494736.8421052,11494736.8421052,11494736.8421052,11494736.8421052,11494736.8421052,11494736.8421052,11494736.8421052,11494736.8421052,11494736.8421052,11494736.8421052,11494736.8421052,11494736.8421052,11494736.8421052,11494736.8421052,11494736.8421052,11494736.8421052],[10357894.7368421,10357894.7368421,10357894.7368421,10357894.7368421,10357894.7368421,10357894.7368421,10357894.7368421,10357894.7368421,10357894.7368421,10357894.7368421,10357894.7368421,10357894.7368421,10357894.7368421,10357894.7368421,10357894.7368421,10357894.7368421,10357894.7368421,10357894.7368421,10357894.7368421,10357894.7368421],[9221052.63157894,9221052.63157894,9221052.63157894,9221052.63157894,9221052.63157894,9221052.63157894,9221052.63157894,9221052.63157894,9221052.63157894,9221052.63157894,9221052.63157894,9221052.63157894,9221052.63157894,9221052.63157894,9221052.63157894,9221052.63157894,9221052.63157894,9221052.63157894,9221052.63157894,9221052.63157894],[8084210.52631578,8084210.52631578,8084210.52631578,8084210.52631578,8084210.52631578,8084210.52631578,8084210.52631578,8084210.52631578,8084210.52631578,8084210.52631578,8084210.52631578,8084210.52631578,8084210.52631578,8084210.52631578,8084210.52631578,8084210.52631578,8084210.52631578,8084210.52631578,8084210.52631578,8084210.52631578],[6947368.42105263,6947368.42105263,6947368.42105263,6947368.42105263,6947368.42105263,6947368.42105263,6947368.42105263,6947368.42105263,6947368.42105263,6947368.42105263,6947368.42105263,6947368.42105263,6947368.42105263,6947368.42105263,6947368.42105263,6947368.42105263,6947368.42105263,6947368.42105263,6947368.42105263,6947368.42105263],[5810526.31578947,5810526.31578947,5810526.31578947,5810526.31578947,5810526.31578947,5810526.31578947,5810526.31578947,5810526.31578947,5810526.31578947,5810526.31578947,5810526.31578947,5810526.31578947,5810526.31578947,5810526.31578947,5810526.31578947,5810526.31578947,5810526.31578947,5810526.31578947,5810526.31578947,5810526.31578947],[4673684.21052631,4673684.21052631,4673684.21052631,4673684.21052631,4673684.21052631,4673684.21052631,4673684.21052631,4673684.21052631,4673684.21052631,4673684.21052631,4673684.21052631,4673684.21052631,4673684.21052631,4673684.21052631,4673684.21052631,4673684.21052631,4673684.21052631,4673684.21052631,4673684.21052631,4673684.21052631],[3536842.10526315,3536842.10526315,3536842.10526315,3536842.10526315,3536842.10526315,3536842.10526315,3536842.10526315,3536842.10526315,3536842.10526315,3536842.10526315,3536842.10526315,3536842.10526315,3536842.10526315,3536842.10526315,3536842.10526315,3536842.10526315,3536842.10526315,3536842.10526315,3536842.10526315,3536842.10526315],[2400000,2400000,2400000,2400000,2400000,2400000,2400000,2400000,2400000,2400000,2400000,2400000,2400000,2400000,2400000,2400000,2400000,2400000,2400000,2400000]])

beta_flight = np.array([[2027.74212062662,np.nan,np.nan,np.nan,2067.29383535861,2073.02193310711,np.nan,np.nan,np.nan,2089.99067170224,2093.28429244528,np.nan,2099.13669944536,np.nan,np.nan,2106.55163335341,np.nan,2110.76415564245,np.nan,np.nan],[1992.55655697327,2005.97927572339,np.nan,2023.31097547572,np.nan,2034.9107930589,2039.53996742157,2043.6299896933,2047.29952558054,2050.62552988795,np.nan,2056.45959523319,np.nan,2061.46403006721,2063.7436386147,2065.84133270531,np.nan,np.nan,np.nan,np.nan],[1953.53767071904,1965.75270817227,1974.53858559121,1981.3911024319,1987.00247129602,np.nan,1995.85155310105,np.nan,2002.70445032535,2005.62403690883,2008.28428029073,2010.72647995489,np.nan,np.nan,np.nan,2018.8415613701,2020.53840880402,np.nan,np.nan,np.nan],[1906.85025563656,1917.05494100826,1924.26614119356,1929.80796894182,1934.28762348988,1938.03355440452,1941.24326196266,1944.04462526154,1946.52510915724,1948.74712116041,1950.75671210315,1952.58881382908,1954.27053073687,1955.83270673788,1957.23024198874,1958.53182260121,np.nan,np.nan,np.nan,np.nan],[1840.72324948635,1846.89353768214,1851.05766881604,1854.15262768494,1856.60076784161,1858.6196498238,1860.33573299883,1861.82834696351,1863.15016882775,1864.33775802807,1865.41740266872,1866.40856341414,1867.35267777348,1868.13757414428,1868.87157906254,np.nan,np.nan,np.nan,np.nan,np.nan],[1730.57988262798,1734.07398632654,1736.92243833307,1739.37985630619,1741.56708946078,1743.55078163425,1745.37316640515,1747.06324965531,1748.64210238458,1750.12564198325,1751.52612673991,1752.89678099939,1754.07878954279,1755.20937055002,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan],[1608.90610504955,1617.06475141978,1623.33417613792,1628.45598390496,1632.79989799036,1636.57918244818,1639.92890406043,1642.94032119971,1645.6782113948,1648.19532136284,1650.56403811749,1652.65497246807,1654.61113035863,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan],[1519.82357907661,1530.70614557257,1538.69878085076,1545.03870051799,1550.30362279542,1554.81176915567,1558.75705956623,1562.26694937303,1565.42973542946,1568.30914171099,1570.9379895967,1573.32849044466,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan],[1450.99411628321,1462.18099171929,1470.33672005088,1476.76900717151,1482.09766881903,1486.6447375988,1490.61333094292,1494.13627790496,1497.30513016739,1500.18238383949,1502.771116643,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan],[1390.43741452185,1401.20790926079,1409.04705832076,1415.22622790721,1420.33329073389,1424.68776129885,1428.48813782531,1431.85994065677,1434.89870621472,1437.59856254025,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan],[1333.55414460118,1343.67875210544,1351.04174097894,1356.84339308167,1361.63558624504,1365.72118776783,1369.2839879242,1372.46116792715,1375.24415573726,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan],[1278.38499218978,1287.77962197148,1294.60873484117,1299.98611125349,1304.42645282194,1308.21088311954,1311.53820906509,1314.40181002753,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan],[1223.9684267592,1232.60019687753,1238.87342141924,1243.81106518736,1247.8867912755,1251.35933004675,1254.3582163372,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan],[1169.7793660771,1177.63615940407,1183.34746075728,1187.84173398426,1191.54988310176,1194.69185371856,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan],[1115.4666522347,1122.53705873869,1127.6832932958,1131.73413596645,1135.06865377716,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan],[1060.65005714259,1066.92083418707,1071.48804309648,1075.09347187961,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan],[1004.67051424931,1010.15231492845,1014.14553689369,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan],[946.147902615098,950.837243389128,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan],[881.604559068664,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan],[np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan]])

beta_original = np.array([[3277.64832816279,2254.27793085765,1725.12816531147,1398.02427211427,1175.63244423475,1035.57479248138,908.46151854772,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan],[3321.47713320141,2282.29213129653,1745.22534473543,1413.21170431865,1193.44970158225,1044.52650627291,921.464273082539,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan],[3359.69887823245,2306.70344211007,1759.45412609316,1429.04225537503,1206.18731207003,1049.24513997632,930.25536162507,817.965463050943,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan],[3379.92840039147,2316.17503799911,1766.80950557297,1432.34471883267,1207.80159853791,1044.73476258045,929.783962955787,821.36270825583,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan],[3343.64463352788,2282.62636020686,1736.05146585713,1403.43796255329,1181.10536655178,1017.08126698815,906.272146116944,801.910608995178,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan],[3158.70154938703,2148.67641931456,1631.12378915431,1317.33174653573,1108.07292394138,954.296458371192,850.050818394758,751.977159916909,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan],[2912.99855554115,1992.84552947001,1519.33057621358,1231.27704330177,1038.55029147951,896.381917308664,800.155552160476,709.43117373243,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan],[2778.42258990061,1909.42745962193,1460.00340235223,1185.26853182866,1001.34608691055,862.986167514226,773.201539887829,688.430230449928,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan],[2723.2799507106,1873.84963341304,1432.34460595504,1162.7456546631,982.750817173225,846.002462478474,759.187470730286,679.53217502335,603.829296266025,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan],[2706.20352697311,1861.65161668082,1424.66810271267,1155.72054054369,972.932479063299,844.437233572627,751.44575069025,676.593680595329,605.449153403689,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan],[2712.43293734017,1865.32545312552,1425.59130796612,1158.34407169914,975.792680212474,847.290255716944,747.074578162353,676.915529821245,610.232405565291,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan],[2738.44951099596,1882.30480443826,1438.60708756567,1165.69009178157,984.411486827667,852.868310093006,747.554172460038,679.264423024514,617.024381026164,557.580502339207,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan],[2784.83574177129,1912.41484697516,1460.98028682159,1184.59119551769,995.535448478428,860.40653415941,762.647913267063,683.077186607811,625.305266773277,570.132881639079,517.229515571477,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan],[2855.94288520804,1959.64562512089,1495.52924225374,1212.37448709588,1020.83582614245,883.06260905439,779.503742740196,694.444551255389,634.888382013375,584.04015245912,535.286841855671,488.383209790608,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan],[2960.10572901663,2028.95211118021,1547.60083338162,1253.34255408346,1054.78151771228,909.441370759624,801.655771030922,720.410657737282,646.618065094194,599.305238568714,554.776559261109,511.940495167452,470.613415768397,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan],[3111.42162901646,2129.83171096599,1623.55949635074,1313.89880683835,1104.82680942626,953.108535726226,840.035137499586,748.730973508548,681.71883217556,618.133918990905,575.756882681047,537.087055739012,499.782265958873,463.704501740294,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan],[3334.07074104001,2278.47291542256,1735.11603960252,1402.72015889958,1179.03731016943,1017.33453563913,895.093498679428,799.703712875245,722.664194739076,662.443850005039,608.293865835095,563.789395094889,530.638622318268,498.580928435786,467.512812472148,437.34623690435,np.nan,np.nan,np.nan,np.nan],[3672.1334028661,2503.50977809688,1903.9143739479,1538.14666425024,1291.45619850575,1113.75175677128,979.636465154599,874.416733953501,790.319202644788,722.049912317129,661.562150835256,616.322796419736,572.699676458734,534.864277768956,507.871930717478,481.665598694762,456.17924627328,431.355644807797,407.144806678049,np.nan],[4212.51073791515,2860.17564935217,2170.46089296697,1750.93199754113,1468.3905375541,1264.94687581859,1111.40899458107,991.52619168719,895.588147095874,816.499276882193,750.918309953408,694.433360170084,646.883319720052,604.358461450145,570.099792995926,536.850311603613,504.524703585017,483.426178626442,463.126440826528,443.30674679038],[5116.05915552148,3441.91340323716,2600.18918448838,2091.38913564959,1750.039742861,1504.97490436387,1320.37782441747,1176.345363641,1060.64755521246,965.973095374283,886.881340136484,820.035799561525,762.422072013088,711.4890409483,669.144966136271,629.59487813121,596.664309066945,564.615392941375,537.59246884311,514.10043006229]])
H0int_original = np.array([7798168.68867308,8084210.52631578,9221052.63157894,9554055.53667177,10357894.7368421,11494736.8421052,12631578.9473684,13768421.0526315,14099658.0379877,14905263.1578947,16042105.2631578,17178947.368421,18315789.4736842,19452631.5789473,20589473.6842105,21726315.7894736,22223911.2427775])
P0int_original = np.array([138777.637154373,135318.420581218,124028.551591544,121052.631578947,116067.055429426,109623.384293363,103834.836827887,98713.1544475231,97368.4210526315,95367.3275237872,93293.7164295333,92234.3581919326,92553.3705724969,92422.6463813721,90668.1120237114,88206.9404848041,87001.8491088011])
betaint_original = np.array([1.1200305278128808, 1.133842531322396, 1.1883449866675413, 1.2042360921294357, 1.2428550032538006, 1.2975323576365876, 1.3527510742102118, 1.4094352004935717, 1.4264544572972269, 1.469726112907731, 1.5374640850949948, 1.6220902477442734, 1.7363807686296406, 1.8502972029899838, 1.9224334538904084, 1.9714279064931957, 1.9895596333286794])

beta_127 = np.array([[5802.95359359745,3991.11463772269,3054.27479827335,2475.14960775225,2081.413206659,1833.44638039225,1608.39709019559,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan],[5880.55085121554,4040.71273026721,3089.8561016601,2502.03838759195,2112.95799340879,1849.29505435434,1631.41798005316,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan],[5948.22101911477,4083.93204168407,3115.04762608415,2530.06578526971,2135.50945566263,1857.64921857957,1646.98227302846,1448.17721366424,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan],[5984.03663035677,4100.70114742649,3128.07004994149,2535.91267312053,2138.36748938741,1849.66376434613,1646.14767934175,1454.19190904832,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan],[5919.79758021183,4041.30447003368,3073.61409273356,2484.73434389304,2091.10281062113,1800.70428622152,1604.52088831459,1419.75269592783,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan],[5592.36277718411,3804.15111706891,2887.84357142453,2332.2865137287,1961.8016065677,1689.54613430613,1504.98313347401,1331.34739470021,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan],[5157.35482991759,3528.25836358252,2689.91787536982,2179.92988501821,1838.71438991468,1587.01060866946,1416.64543354145,1256.02131981262,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan],[4919.09312358518,3380.56979552091,2584.88133627605,2098.47353880349,1772.84573928937,1527.88468456852,1368.92436443361,1218.83993636675,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan],[4821.46514638623,3317.58058686258,2535.91247327492,2058.59762842499,1739.92351074552,1497.81567096417,1344.11297991749,1203.08626252992,1069.05715130531,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan],[4791.23197779343,3295.98445514131,2522.32151182436,2046.15992701744,1722.54051088901,1495.0444918154,1330.40655456949,1197.88376821278,1071.92504769229,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan],[4802.26091551225,3302.48884495516,2523.95601214494,2050.80479065812,1727.60438988859,1500.0956606558,1322.66755734058,1198.45359021171,1080.39361647734,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan],[4848.32228466273,3332.550150456,2546.99996239174,2063.81064405297,1742.86366416473,1509.97139699051,1323.51666108039,1202.61221764521,1092.41855462267,987.175394006599,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan],[4930.44736875374,3385.85885293074,2586.61087363773,2097.274340236,1762.55822159533,1523.31754033957,1350.23956381048,1209.36257275413,1107.07955265943,1009.39891138047,915.735483367908,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan],[5056.33990273649,3469.4791765067,2647.77850512441,2146.46361729185,1807.35159256906,1563.4292723088,1380.08217852108,1229.48806607341,1124.04609923569,1034.02121344042,947.70530317782,864.66417948372,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan],[5240.75631605476,3592.18371405023,2739.96930676213,2218.99604534571,1867.45116798407,1610.13188183428,1419.30151485762,1275.46008498286,1144.81306376961,1061.0474766106,982.211117814585,906.371470854292,833.203424773505,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan],[5508.65544913979,3770.78726680712,2874.45127435278,2326.20862258269,1956.05448240892,1687.44296175944,1487.25074560813,1325.60014325714,1206.95765711193,1094.3829500291,1019.35599456614,950.892514427368,884.845781453303,820.971451275082,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan],[5902.84736217293,4033.95095161934,3071.95795558819,2483.46349941105,2087.44139425972,1801.15268888136,1584.72951174691,1415.84546901156,1279.44988783343,1172.83202316522,1076.96150449723,998.168006063013,939.475804595976,882.718858367375,827.713922777305,774.305130688922,np.nan,np.nan,np.nan,np.nan],[6501.37464206707,4432.37028774129,3370.8090838396,2723.2310544414,2286.47482516631,1971.85576738005,1734.40966715134,1548.12207429265,1399.23054516569,1278.36232381465,1171.27100781107,1091.17642535636,1013.94332546381,946.957169290344,899.168229892504,852.770900661192,807.648268345472,763.699011772574,720.834629733217,np.nan],[7458.09247276832,5063.83385310633,3842.71971168588,3099.95951669755,2599.73044499265,2239.54106231278,1967.70799467552,1755.45998262184,1585.6052682401,1445.58138597165,1329.47274050134,1229.46825267606,1145.282687149,1069.99401844277,1009.34032917718,950.473367803408,893.242089632121,855.887941483899,819.948016079783,784.857990178337],[9057.79110177801,6093.77875611257,4603.53755542094,3702.72612715933,3098.37981320771,2664.50169608268,2337.67948052088,2082.67540376382,1877.83676765301,1710.21918274639,1570.1901926508,1451.84266690729,1349.83972032969,1259.66469663644,1184.69609827075,1114.67414889197,1056.37180984945,999.630404310678,951.78732939683,910.195554680566]])
# H0int_127 = np.array([10882772.9552042,11494736.8421052,11727139.536724,12631578.9473684,13768421.0526315,14905263.1578947,15238603.0030454,16042105.2631578,17178947.368421,18315789.4736842,19452631.5789473,20589473.6842105,21013586.5944589,19452631.5789473,20589473.6842105,21726315.7894736,22223911.2427775])
# P0int_127 = np.array([203040.226040439,194397.455627206,192105.263157894,186005.103786618,178313.953956565,170099.067360912,168421.052631578,165864.637901992,163825.865339482,163757.030848426,163730.224950569,161264.372261865,159585.367001403,92422.6463813721,90668.1120237114,88206.9404848041,87001.8491088011])
H0int_127 = np.array([10882772.9552042,11494736.8421052,11727139.536724,12631578.9473684,13768421.0526315,14905263.1578947,15238603.0030454,16042105.2631578,17178947.368421,18315789.4736842,19452631.5789473,20589473.6842105,21013586.5944589])
P0int_127 = np.array([203040.226040439,194397.455627206,192105.263157894,186005.103786618,178313.953956565,170099.067360912,168421.052631578,165864.637901992,163825.865339482,163757.030848426,163730.224950569,161264.372261865,159585.367001403])
betaint_127 = np.array([1.2820126083862873, 1.3118300992868697, 1.3232490820696239, 1.3684090124022614, 1.4263344949438947, 1.4869432590289693, 1.5057664374083282, 1.5543552069125874, 1.6358831132710385, 1.743174077469905, 1.8582470812995222, 1.9369656510172686, 1.9584564366394928])

beta_381 = np.array([[973.187452434504,681.215530922976,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan],[986.818438556416,688.029103314167,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan],[997.365179765122,692.584290329609,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan],[1001.33786420118,692.304932635933,526.008168247513,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan],[990.306671597382,679.483866136256,519.070993277017,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan],[935.649694997939,639.626170534146,487.587153601009,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan],[862.313409426474,593.876324484611,453.830240361371,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan],[823.129276775272,567.61960752203,437.440980385736,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan],[807.609440363559,555.352158029127,431.547841094349,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan],[802.17736096484,554.221132920427,430.439287165245,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan],[802.937031351615,556.458233461837,431.79662163435,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan],[810.980032055662,560.679619508066,434.627267943007,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan],[824.306261554887,566.274959948445,438.488861270995,355.311034912838,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan],[844.820628247193,582.153649429392,443.208085791331,366.526790690672,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan],[874.987025019923,600.627254149196,461.543878547515,378.68056997311,314.795674810284,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan],[918.9531697249,630.237182135892,481.963798164616,391.811615473908,334.121416981925,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan],[983.502735792125,674.321955400488,515.094913829678,418.438703666337,354.605647259625,307.152164034212,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan],[1081.13207153368,739.997103077055,563.223756424449,456.573257235589,384.846535536594,334.767246277904,296.197521708429,259.836033512485,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan],[1235.73167924259,843.603838472793,641.947890763167,518.382849057121,436.183851344942,377.187138081609,329.971731578319,299.465936640719,270.531407101095,242.945068629801,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan],[1488.2943699987,1011.47523500441,766.958345176202,618.182960492237,517.43672880187,446.220956199915,392.214241961547,350.111404237621,315.775596217381,288.650576707327,267.913445483532,248.000464064073,228.820114032091,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan]])
H0int_381 = np.array([4249426.0884182,4673684.21052631,5656417.30703596])
P0int_381 = np.array([64845.4996490634,59244.5597057644,50000])
betaint_381 = np.array([0.92602049998919, 0.9482011449730728, 0.9969312142227377])





fig6 = plt.figure("6",figsize=(10,5))

ax = plt.axes(projection='3d')
ax.view_init(30,160)
surf = ax.plot_surface(H0square/(10**6), P0square/(10**3), beta_original/(10**3),  alpha=0.3)
surf = ax.plot_surface(H0square/(10**6), P0square/(10**3), beta_127/(10**3),   alpha=0.3)
surf = ax.plot_surface(H0square/(10**6), P0square/(10**3), beta_381/(10**3), alpha=0.3)
surf = ax.plot_surface(H0square/(10**6), P0square/(10**3), beta_flight/(10**3), alpha=0.3)
ax.plot3D(H0int_original/(10**6), P0int_original/(10**3), betaint_original, linestyle = 'solid', color = 'k')
ax.plot3D(H0int_127/(10**6), P0int_127/(10**3), betaint_127, linestyle = 'solid',color = "m")
ax.plot3D(H0int_381/(10**6), P0int_381/(10**3), betaint_381, linestyle = 'solid',color ="r")




# surf = ax.plot_surface(H0_grid_PWK/(10**6), P0_grid_PWK/(10**3), beta_square_PWK/(10**3), linewidth=1, antialiased=False, rcount=200, ccount=200, alpha=0.5)
# ax.plot3D(intercept_H0, intercept_P0, intercept_beta, color='k')
ax.set_zlim(0, 4)
# ax.legend(["flight", "PWK", "line"])
# plt.gcf().set_size_inches(16, 8)
ax.set_xlabel("H0 (MJ/kg)")
ax.set_ylabel("P0 (kPa)")
ax.set_zlabel("$\mathregular{\u03B2t_0}$ ($\mathregular{ 10^{-3}}$ $\mathregular{s^{-1}}$)")


plt.savefig('1.png', dpi=300)
plt.show()


dat_fight_altitude_square = [np.array([33.20163711,         np.nan,         np.nan,         np.nan, 19.63650447,       17.72631666,         np.nan,         np.nan,         np.nan, 12.12993024,       11.05388453,         np.nan,  9.14890825,         np.nan,         np.nan,        6.75229433,         np.nan,  5.38084362,         np.nan,         np.nan]), np.array([32.57495949, 27.59454076,         np.nan, 21.28142123,         np.nan,       17.11575924, 15.46285248, 14.00538817, 12.7021867 , 11.52383172,               np.nan,  9.4599083 ,         np.nan,  7.69355884,  6.89747307,        6.14998539,         np.nan,         np.nan,         np.nan,         np.nan]), np.array([31.91716743, 26.94286804, 23.39436336, 20.636417  , 18.38141899,               np.nan, 14.8231304 ,         np.nan, 12.06472935, 10.88729884,        9.81287015,  8.82493777,         np.nan,         np.nan,         np.nan,        5.51737958,  4.81340358,         np.nan,         np.nan,         np.nan]), np.array([31.22494307, 26.25696458, 22.71247886, 19.95741337, 17.70462929,       15.79960153, 14.14960063, 12.6946082 , 11.39354877, 10.21707759,        9.14350287,  8.15633829,  7.24276142,  6.39260338,  5.59766428,        4.85123595,         np.nan,         np.nan,         np.nan,         np.nan]), np.array([30.49440563, 25.53296951, 21.99264929, 19.24057238, 16.99008653,       15.08690827, 13.43844431, 11.98475994, 10.68483453,  9.50936104,        8.43667464,  7.4503089 ,  6.53745646,  5.6879601 ,  4.89362912,               np.nan,         np.nan,         np.nan,         np.nan,         np.nan]), np.array([29.72097616, 24.76632709, 21.23033426, 18.481365  , 16.23327057,       14.33201782, 12.68515467, 11.23283321,  9.93408973,  8.75965635,        7.68789626,  6.70236371,  5.79026699,  4.941461  ,         np.nan,               np.nan,         np.nan,         np.nan,         np.nan,         np.nan]), np.array([28.89919907, 23.95160896, 20.42012351, 17.67439429, 15.42879492,       13.52955227, 11.88436097, 10.43346345,  9.13595522,  7.96260918,        6.8918177 ,  5.90715658,  4.99585042,         np.nan,         np.nan,               np.nan,         np.nan,         np.nan,         np.nan,         np.nan]), np.array([28.02250248, 23.08227562, 19.55549903, 16.81315809, 14.57016987,       12.67303203, 11.0295922 ,  9.58018701,  8.28397379,  7.11176803,        6.04199258,  5.05824576,         np.nan,         np.nan,         np.nan,               np.nan,         np.nan,         np.nan,         np.nan,         np.nan]), np.array([27.08287075, 22.1503503 , 18.62850986, 15.88972449, 13.64947845,       11.7545524 , 10.11295393,  8.66511832,  7.37026763,  6.19926196,        5.13055612,         np.nan,         np.nan,         np.nan,         np.nan,               np.nan,         np.nan,         np.nan,         np.nan,         np.nan]), np.array([26.07038704, 21.14596349, 17.62931795, 14.89427866, 12.65692407,       10.76433165,  9.12467702,  7.67849903,  6.38508783,  5.21535045,               np.nan,         np.nan,         np.nan,         np.nan,         np.nan,               np.nan,         np.nan,         np.nan,         np.nan,         np.nan]), np.array([24.97257888, 20.05670123, 16.54554825, 13.81447426, 11.58018294,        9.69006449,  8.0524717 ,  6.60805276,  5.31616972,         np.nan,               np.nan,         np.nan,         np.nan,         np.nan,         np.nan,               np.nan,         np.nan,         np.nan,         np.nan,         np.nan]), np.array([23.7734551 , 18.86664598, 15.36133218, 12.6344789 , 10.40345111,        8.51597023,  6.88057687,  5.43803529,         np.nan,         np.nan,               np.nan,         np.nan,         np.nan,         np.nan,         np.nan,               np.nan,         np.nan,         np.nan,         np.nan,         np.nan]), np.array([22.45204085, 17.55491751, 14.05585253, 11.33352195,  9.10599454,        7.22134479,  5.58831372,         np.nan,         np.nan,         np.nan,               np.nan,         np.nan,         np.nan,         np.nan,         np.nan,               np.nan,         np.nan,         np.nan,         np.nan,         np.nan]), np.array([20.98005978, 16.09336426, 12.60104088,  9.88359647,  7.65985465,        5.77826916,         np.nan,         np.nan,         np.nan,         np.nan,               np.nan,         np.nan,         np.nan,         np.nan,         np.nan,               np.nan,         np.nan,         np.nan,         np.nan,         np.nan]), np.array([19.31808751, 14.44273164, 10.95775587,  8.24564486,  6.02603976,               np.nan,         np.nan,         np.nan,         np.nan,         np.nan,               np.nan,         np.nan,         np.nan,         np.nan,         np.nan,               np.nan,         np.nan,         np.nan,         np.nan,         np.nan]), np.array([17.4087789 , 12.54591485,  9.06905309,  6.36284152,         np.nan,               np.nan,         np.nan,         np.nan,         np.nan,         np.nan,               np.nan,         np.nan,         np.nan,         np.nan,         np.nan,               np.nan,         np.nan,         np.nan,         np.nan,         np.nan]), np.array([15.16400742, 10.31514541,  6.84740331,         np.nan,         np.nan,               np.nan,         np.nan,         np.nan,         np.nan,         np.nan,               np.nan,         np.nan,         np.nan,         np.nan,         np.nan,               np.nan,         np.nan,         np.nan,         np.nan,         np.nan]), np.array([12.43787149,  7.60509358,         np.nan,         np.nan,         np.nan,               np.nan,         np.nan,         np.nan,         np.nan,         np.nan,               np.nan,         np.nan,         np.nan,         np.nan,         np.nan,               np.nan,         np.nan,         np.nan,         np.nan,         np.nan]), np.array([8.96150282,        np.nan,        np.nan,        np.nan,        np.nan,              np.nan,        np.nan,        np.nan,        np.nan,        np.nan,             np.nan,        np.nan,        np.nan,        np.nan,        np.nan,              np.nan,        np.nan,        np.nan,        np.nan,        np.nan]), np.array([np.nan, np.nan, np.nan, np.nan, np.nan, np.nan, np.nan, np.nan, np.nan, np.nan, np.nan, np.nan, np.nan,       np.nan, np.nan, np.nan, np.nan, np.nan, np.nan, np.nan])]
dat_fight_velocity_square = [[6928.2032302755,np.nan,np.nan,np.nan,6928.2032302755,6928.2032302755,np.nan,np.nan,np.nan,6928.2032302755,6928.2032302755,np.nan,6928.2032302755,np.nan,np.nan,6928.2032302755,np.nan,6928.2032302755,np.nan,np.nan],[6762.12361536475,6762.12361536475,np.nan,6762.12361536475,np.nan,6762.12361536475,6762.12361536475,6762.12361536475,6762.12361536475,6762.12361536475,np.nan,6762.12361536475,np.nan,6762.12361536475,6762.12361536475,6762.12361536475,np.nan,np.nan,np.nan,np.nan],[6591.86101028741,6591.86101028741,6591.86101028741,6591.86101028741,6591.86101028741,np.nan,6591.86101028741,np.nan,6591.86101028741,6591.86101028741,6591.86101028741,6591.86101028741,np.nan,np.nan,np.nan,6591.86101028741,6591.86101028741,np.nan,np.nan,np.nan],[6417.08246545274,6417.08246545274,6417.08246545274,6417.08246545274,6417.08246545274,6417.08246545274,6417.08246545274,6417.08246545274,6417.08246545274,6417.08246545274,6417.08246545274,6417.08246545274,6417.08246545274,6417.08246545274,6417.08246545274,6417.08246545274,np.nan,np.nan,np.nan,np.nan],[6237.40836869726,6237.40836869726,6237.40836869726,6237.40836869726,6237.40836869726,6237.40836869726,6237.40836869726,6237.40836869726,6237.40836869726,6237.40836869726,6237.40836869726,6237.40836869726,6237.40836869726,6237.40836869726,6237.40836869726,np.nan,np.nan,np.nan,np.nan,np.nan],[6052.40274166949,6052.40274166949,6052.40274166949,6052.40274166949,6052.40274166949,6052.40274166949,6052.40274166949,6052.40274166949,6052.40274166949,6052.40274166949,6052.40274166949,6052.40274166949,6052.40274166949,6052.40274166949,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan],[5861.56077652037,5861.56077652037,5861.56077652037,5861.56077652037,5861.56077652037,5861.56077652037,5861.56077652037,5861.56077652037,5861.56077652037,5861.56077652037,5861.56077652037,5861.56077652037,5861.56077652037,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan],[5664.29258833932,5664.29258833932,5664.29258833932,5664.29258833932,5664.29258833932,5664.29258833932,5664.29258833932,5664.29258833932,5664.29258833932,5664.29258833932,5664.29258833932,5664.29258833932,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan],[5459.90167638479,5459.90167638479,5459.90167638479,5459.90167638479,5459.90167638479,5459.90167638479,5459.90167638479,5459.90167638479,5459.90167638479,5459.90167638479,5459.90167638479,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan],[5247.55582202449,5247.55582202449,5247.55582202449,5247.55582202449,5247.55582202449,5247.55582202449,5247.55582202449,5247.55582202449,5247.55582202449,5247.55582202449,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan],[5026.24689950034,5026.24689950034,5026.24689950034,5026.24689950034,5026.24689950034,5026.24689950034,5026.24689950034,5026.24689950034,5026.24689950034,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan],[4794.73395343375,4794.73395343375,4794.73395343375,4794.73395343375,4794.73395343375,4794.73395343375,4794.73395343375,4794.73395343375,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan],[4551.46014743446,4551.46014743446,4551.46014743446,4551.46014743446,4551.46014743446,4551.46014743446,4551.46014743446,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan],[4294.42723342215,4294.42723342215,4294.42723342215,4294.42723342215,4294.42723342215,4294.42723342215,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan],[4020.99751960027,4020.99751960027,4020.99751960027,4020.99751960027,4020.99751960027,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan],[3727.56446518437,3727.56446518437,3727.56446518437,3727.56446518437,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan],[3408.96650490716,3408.96650490716,3408.96650490716,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan],[3057.34663083082,3057.34663083082,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan],[2659.63986481747,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan],[np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan]]







fig100 = plt.figure("100",figsize=(8,6))
plt.contourf(H0square/(10**6), P0square/(10**3),dat_fight_altitude_square)
plt.xlabel("$\mathregular{H_0}$ (MJ/kg)")
plt.ylabel("$\mathregular{P_0}$ (kPa)")
plt.colorbar()
plt.title("Altitude, Flight (km)")
plt.plot(H0int_original/(10**6), P0int_original/(10**3), 'k')
plt.plot(H0int_127/(10**6), P0int_127/(10**3), "m")
plt.plot(H0int_381/(10**6), P0int_381/(10**3),"r")
plt.savefig('flight_alt.png', dpi=300)
plt.show()

fig101 = plt.figure("101",figsize=(8,6))
plt.contourf(H0square/(10**6), P0square/(10**3), dat_fight_velocity_square)
plt.xlabel("$\mathregular{H_0}$ (MJ/kg)")
plt.ylabel("$\mathregular{P_0}$ (kPa)")
plt.colorbar()
plt.title("Velocity, Flight (m/s)")
plt.plot(H0int_original/(10**6), P0int_original/(10**3), 'k')
plt.plot(H0int_127/(10**6), P0int_127/(10**3), "m")
plt.plot(H0int_381/(10**6), P0int_381/(10**3),"r")
plt.savefig('flight_vel.png', dpi=300)
plt.show()