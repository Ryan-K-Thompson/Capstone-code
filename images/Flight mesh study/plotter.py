# -*- coding: utf-8 -*-
"""
Created on Sun Oct  2 10:19:14 2022

@author: patag
"""


import csv
from pandas import *
import matplotlib.pyplot as plt
import math
import numpy as np


def extract_values(File, value):
    temp = read_csv(File)
    print(temp)
    # temp = temp.dropna
    # temp=list(temp[temp!=np.isnan]) 
    NaN_present = True in (ele == 'nan' for ele in temp)
    if NaN_present == True:
        while NaN in temp:
            temp.remove(NaN)
    values_array = temp[value].tolist()
    return values_array

def XY_to_pathlength(X,Y):
    S = []
    for count,x in enumerate(X):
        if count == 0:
            S.append(0)
        else:
            s = ((X[count]-X[count-1])**2+(Y[count]-Y[count-1])**2)**0.5 + S[count - 1]
            S.append(s)
    return S

def scale_by(List, scale_factor):
    new_List = [i*scale_factor for i in List]
    return new_List

x_100x100 = [0.000000000368371222,0.000155930786,0.000623648695,0.00140293431,0.00249342108,0.00389459636,0.00560580147,0.00762623176,0.0099549368,0.0125908228,0.0155326501,0.0187790338,0.0223284513,0.0261792298,0.0303295609,0.0347774923,0.0395209342,0.0444387384,0.0493579507,0.054277163,0.0591963753,0.0641155913,0.0690347999,0.073954016,0.0788732246,0.0837924406,0.0887116492,0.0936308652,0.0985500813,0.10346929,0.108388506,0.113307714,0.11822693,0.123146139,0.128065348,0.132984564,0.13790378,0.142822996,0.147742197,0.152661413,0.157580629,0.162499845,0.167419061,0.172338262,0.177257478,0.182176694,0.18709591,0.192015111,0.196934327,0.201853544,0.20677276,0.211691976,0.216611177,0.221530393,0.226449609,0.231368825,0.236288041,0.241207242,0.246126458,0.251045674,0.255964875,0.260884106,0.265803307,0.270722508,0.275641739,0.280560941,0.285480142,0.290399373,0.295318574,0.300237805,0.305157006,0.310076207,0.314995438,0.319914639,0.32483387,0.329753071,0.334672272,0.339591503,0.344510704,0.349429935,0.354349136,0.359268337,0.364187568,0.36910677,0.374026,0.378945202,0.383864403,0.388783634,0.393702835,0.398622066,0.403541267,0.408460468,0.413379699,0.4182989,0.423218101,0.429359108,0.438102484,0.449058205,0.461729556,0.475542098]
y_100x100 = [8.1230817E-17,0.014381689,0.0287566148,0.0431180224,0.057459157,0.0717732757,0.0860536471,0.100293562,0.114486322,0.128625244,0.142703712,0.156715065,0.170652747,0.184510201,0.198280886,0.211958364,0.225536183,0.239052117,0.25256753,0.266082972,0.279598385,0.293113798,0.306629241,0.320144653,0.333660096,0.347175509,0.360690951,0.374206364,0.387721807,0.40123722,0.414752662,0.428268075,0.441783488,0.45529893,0.468814343,0.482329786,0.495845199,0.509360611,0.522876024,0.536391497,0.549906909,0.563422322,0.576937735,0.590453148,0.60396862,0.617484033,0.630999446,0.644514859,0.658030331,0.671545744,0.685061157,0.69857657,0.712091982,0.725607455,0.739122868,0.75263828,0.766153693,0.779669166,0.793184578,0.806699991,0.820215404,0.833730876,0.847246289,0.860761702,0.874277115,0.887792528,0.901308,0.914823413,0.928338826,0.941854239,0.955369711,0.968885124,0.982400537,0.995915949,1.00943136,1.02294683,1.03646219,1.04997766,1.06349301,1.07700849,1.09052396,1.10403931,1.11755478,1.13107014,1.14458561,1.15810108,1.17161644,1.18513191,1.19864738,1.21216273,1.22567821,1.23919356,1.25270903,1.2662245,1.27973986,1.29271638,1.30410218,1.31337869,1.32012546,1.32403648]
s_100x100 = XY_to_pathlength(x_100x100, y_100x100)
s_div_r_100x100 = scale_by(s_100x100, 1/1.35)
qdot_flight_100x100 = [246298.5,274140.75,328671.438,372933.469,401042.75,416117.75,421553.5,421134.031,417513.875,412516.781,406742.625,399868.531,390597.219,377942.781,362081.062,340304.594,309474.969,281380.656,266966.875,260324.828,255892.391,252902.125,251243.016,250583.906,250375.828,250208.766,249933.875,249555.766,249144.031,248769.25,248532.812,248550.797,248822.109,249184.641,249473.625,249590,249504.672,249232.672,248834.203,248382.453,247898.531,247396.031,246857.641,246217.938,245466.875,244626.531,243701.391,242720.422,241722.672,240717,239708.172,238728.219,237807.875,236927.172,236030.906,235087.484,234099.172,233047.438,231890.25,230623.031,229268.969,227869.906,226461.703,225056.312,223667.109,222324.609,221065.188,219922.109,218935,218121.828,217493.016,217083.938,216920.875,217010.812,217356.047,217939.312,218718.859,219641.625,220661.688,221745.438,222876.469,224048.031,225270.047,226598.859,228114.25,229899,232107.078,235016.672,238930.906,244273.266,252222.375,266503.844,353113.75,836841.375,1378637.38,1311615.25,880668.625,505606.688,267140.656,175057.812]
qdot_flight_100x100 = scale_by(qdot_flight_100x100, 1/(100*100))

x_200x100 = [0.000000000368371222,0.000155930786,0.000623648695,0.00140293431,0.00249342108,0.00389459636,0.00560580147,0.00762623176,0.0099549368,0.0125908228,0.0155326501,0.0187790338,0.0223284513,0.0261792298,0.0303295609,0.0347774923,0.0395209342,0.0444387384,0.0493579507,0.054277163,0.0591963753,0.0641155913,0.0690347999,0.073954016,0.0788732246,0.0837924406,0.0887116492,0.0936308652,0.0985500813,0.10346929,0.108388506,0.113307714,0.11822693,0.123146139,0.128065348,0.132984564,0.13790378,0.142822996,0.147742197,0.152661413,0.157580629,0.162499845,0.167419061,0.172338262,0.177257478,0.182176694,0.18709591,0.192015111,0.196934327,0.201853544,0.20677276,0.211691976,0.216611177,0.221530393,0.226449609,0.231368825,0.236288041,0.241207242,0.246126458,0.251045674,0.255964875,0.260884106,0.265803307,0.270722508,0.275641739,0.280560941,0.285480142,0.290399373,0.295318574,0.300237805,0.305157006,0.310076207,0.314995438,0.319914639,0.32483387,0.329753071,0.334672272,0.339591503,0.344510704,0.349429935,0.354349136,0.359268337,0.364187568,0.36910677,0.374026,0.378945202,0.383864403,0.388783634,0.393702835,0.398622066,0.403541267,0.408460468,0.413379699,0.4182989,0.423218101,0.429359108,0.438102484,0.449058205,0.461729556,0.475542098]
y_200x100 = [8.1230817E-17,0.014381689,0.0287566148,0.0431180224,0.057459157,0.0717732757,0.0860536471,0.100293562,0.114486322,0.128625244,0.142703712,0.156715065,0.170652747,0.184510201,0.198280886,0.211958364,0.225536183,0.239052117,0.25256753,0.266082972,0.279598385,0.293113798,0.306629241,0.320144653,0.333660096,0.347175509,0.360690951,0.374206364,0.387721807,0.40123722,0.414752662,0.428268075,0.441783488,0.45529893,0.468814343,0.482329786,0.495845199,0.509360611,0.522876024,0.536391497,0.549906909,0.563422322,0.576937735,0.590453148,0.60396862,0.617484033,0.630999446,0.644514859,0.658030331,0.671545744,0.685061157,0.69857657,0.712091982,0.725607455,0.739122868,0.75263828,0.766153693,0.779669166,0.793184578,0.806699991,0.820215404,0.833730876,0.847246289,0.860761702,0.874277115,0.887792528,0.901308,0.914823413,0.928338826,0.941854239,0.955369711,0.968885124,0.982400537,0.995915949,1.00943136,1.02294683,1.03646219,1.04997766,1.06349301,1.07700849,1.09052396,1.10403931,1.11755478,1.13107014,1.14458561,1.15810108,1.17161644,1.18513191,1.19864738,1.21216273,1.22567821,1.23919356,1.25270903,1.2662245,1.27973986,1.29271638,1.30410218,1.31337869,1.32012546,1.32403648]
s_200x100 = XY_to_pathlength(x_200x100, y_200x100)
s_div_r_200x100 = scale_by(s_200x100, 1/1.35)
qdot_flight_200x100 = [368805.188,377257.969,394011.625,407669.344,415294.438,418117.094,417857.031,415699.969,412257.219,407773.812,402594.281,396521.438,388541.594,377265.562,363730.812,344384.906,313562.562,286897.5,275022.875,269343.406,265922.781,263447.406,261455.531,259796.609,258272.094,256575.078,254622.812,252646.297,250936.734,249536.5,248246.297,246927.297,245637.688,244473.328,243420.734,242391.797,241318.797,240184.344,239002.109,237797.734,236599.984,235433.484,234309.344,233223.859,232171.938,231155.094,230169.734,229219.125,228333.516,227571.219,226991.375,226609.688,226384.438,226247.078,226136.25,226004.781,225828.891,225603.688,225332.266,225020.719,224680.328,224322.797,223950.688,223564.766,223167.047,222761.625,222356.656,221965.828,221600.469,221265.281,220967.297,220710.078,220496.625,220341.234,220258.5,220252.984,220328.234,220491.25,220747.484,221103.125,221583.938,222230.203,223081.594,224194.328,225654.781,227561.312,229993.078,233115.781,237320.484,243307.188,252189.562,266755.281,325682.375,636992.75,988470.312,929156.5,615146.625,348378.5,172790.172,99135.2656]
qdot_flight_200x100 = scale_by(qdot_flight_200x100, 1/(100*100))

x_300x100 = [0.000000000368371222,0.000155930786,0.000623648695,0.00140293431,0.00249342108,0.00389459636,0.00560580147,0.00762623176,0.0099549368,0.0125908228,0.0155326501,0.0187790338,0.0223284513,0.0261792298,0.0303295609,0.0347774923,0.0395209342,0.0444387384,0.0493579507,0.054277163,0.0591963753,0.0641155913,0.0690347999,0.073954016,0.0788732246,0.0837924406,0.0887116492,0.0936308652,0.0985500813,0.10346929,0.108388506,0.113307714,0.11822693,0.123146139,0.128065348,0.132984564,0.13790378,0.142822996,0.147742197,0.152661413,0.157580629,0.162499845,0.167419061,0.172338262,0.177257478,0.182176694,0.18709591,0.192015111,0.196934327,0.201853544,0.20677276,0.211691976,0.216611177,0.221530393,0.226449609,0.231368825,0.236288041,0.241207242,0.246126458,0.251045674,0.255964875,0.260884106,0.265803307,0.270722508,0.275641739,0.280560941,0.285480142,0.290399373,0.295318574,0.300237805,0.305157006,0.310076207,0.314995438,0.319914639,0.32483387,0.329753071,0.334672272,0.339591503,0.344510704,0.349429935,0.354349136,0.359268337,0.364187568,0.36910677,0.374026,0.378945202,0.383864403,0.388783634,0.393702835,0.398622066,0.403541267,0.408460468,0.413379699,0.4182989,0.423218101,0.429359108,0.438102484,0.449058205,0.461729556,0.475542098]
y_300x100 = [8.1230817E-17,0.014381689,0.0287566148,0.0431180224,0.057459157,0.0717732757,0.0860536471,0.100293562,0.114486322,0.128625244,0.142703712,0.156715065,0.170652747,0.184510201,0.198280886,0.211958364,0.225536183,0.239052117,0.25256753,0.266082972,0.279598385,0.293113798,0.306629241,0.320144653,0.333660096,0.347175509,0.360690951,0.374206364,0.387721807,0.40123722,0.414752662,0.428268075,0.441783488,0.45529893,0.468814343,0.482329786,0.495845199,0.509360611,0.522876024,0.536391497,0.549906909,0.563422322,0.576937735,0.590453148,0.60396862,0.617484033,0.630999446,0.644514859,0.658030331,0.671545744,0.685061157,0.69857657,0.712091982,0.725607455,0.739122868,0.75263828,0.766153693,0.779669166,0.793184578,0.806699991,0.820215404,0.833730876,0.847246289,0.860761702,0.874277115,0.887792528,0.901308,0.914823413,0.928338826,0.941854239,0.955369711,0.968885124,0.982400537,0.995915949,1.00943136,1.02294683,1.03646219,1.04997766,1.06349301,1.07700849,1.09052396,1.10403931,1.11755478,1.13107014,1.14458561,1.15810108,1.17161644,1.18513191,1.19864738,1.21216273,1.22567821,1.23919356,1.25270903,1.2662245,1.27973986,1.29271638,1.30410218,1.31337869,1.32012546,1.32403648]
s_300x100 = XY_to_pathlength(x_300x100, y_300x100)
s_div_r_300x100 = scale_by(s_300x100, 1/1.35)
qdot_flight_300x100 = [406063.469,411177.125,419950.688,424110.875,423639.594,421042.406,417635.594,413809.531,409760.688,405811.219,401510.156,396062.531,388453.375,377395.75,364221.594,345802.656,315764.281,289958.562,278623.188,272609.625,268811.375,266003.5,263693.906,261586.953,259532.969,257612.359,255916.25,254382.141,252926.516,251525.172,250163.969,248811.547,247436.859,246039.25,244638.469,243251.938,241887.031,240549.516,239249.562,237992.094,236782.141,235619.594,234493.344,233394.156,232317.297,231265.141,230245.844,229264.828,228317.922,227394.656,226488.766,225602.312,224741.906,223911.625,223109.453,222328.422,221562.766,220816.938,220101.844,219424.594,218782.609,218166.672,217569.969,216992.594,216444,215942.906,215515,215190.594,214997.719,214951.828,215048.75,215267.391,215575.359,215936.547,216323.516,216720.172,217129.219,217567.5,218048.078,218585.812,219205.516,219942.453,220847.5,221999.094,223458.344,225295.469,227652.391,230814.625,235183.562,241503.094,251267.469,266199.125,314092,564430.438,851806.438,797043.938,524368.75,295819.594,140855.266,72507.1641]
qdot_flight_300x100 = scale_by(qdot_flight_300x100, 1/(100*100))



fig1 = plt.figure("Figure 1")
plt.plot(s_div_r_100x100,qdot_flight_100x100, color = 'k')
plt.plot(s_div_r_200x100,qdot_flight_200x100, color = 'r')
plt.plot(s_div_r_300x100,qdot_flight_300x100, color = 'b')
plt.grid()
plt.xlabel('Normalised wall pathlength (S/R)')
plt.ylabel('Heat transfer ($\mathregular{W/cm^{2}}$)')
#plt.title('Flight heat transfer')
plt.xlim(0,1.2)
plt.legend(["100x100","200x100","300x100"])

plt.savefig('plt_flight_mesh_study.png', dpi=300)
plt.show()

